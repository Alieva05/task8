<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Задание 3</title>
    <link rel="stylesheet" href="style.css">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <div class="container-fluid header m-0">
        <header class="d-flex flex-wrap justify-content-center py-3 mb-4">
          <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
            <div class="logo">
                <img src="./images/свинка.png" alt="свинка">
            </div>
            <div class="site-link m-auto">
                <a href = "images/шашлык.jpg">Шашлычка у Анжи</a>
            </div>
        
          </a>
    
          <ul class="nav nav-pills ">
            <li class="nav nav-item"><a href="#" class="nav-link">Главная</a></li>
            <li class="nav nav-item"><a href="#" class="nav-link">О нас</a></li>
            <li class="nav nav-item"><a href="#" class="nav-link">Услуги</a></li>
            <li class="nav nav-item"><a href="#" class="nav-link">Контакты</a></li>
          </ul>
        </header>
      </div>
      <div class="container ">
        <div class = "main d-flex">
            <div class="sslk  d-flex">
                <ul>
                    <li><a href="http://kubsu.ru">КубГУ (абсолютная гиперссылка)</a></li>
                    <li><a href="https://kubsu.ru">КубГУ (гиперссылка c протоколом https)</a></li>
                    <li><a href="https://kubsu.ru"><img src="images/цветок.jpg" width="100 px" alt="Цветок"></a></li>
                    <li><a href="v-page.html">Сокращенная ссылка на внутреннюю страницу</a></li>
                    <li><a href="index.html">Сокращенная ссылка на главную страницу</a></li>
                    <li><a href="#fragment-page">Ссылка на фрагмент текущей страницы</a></li>
                    <li><a href="index.html?p1=v1&?p2=v2&?p3=v3">Ссылка с тремя параметрами в URL</a></li>
                    <li><a href="index.html?id=fragment-page">Ссылка с параметром id в URL</a></li>
                    <li><a href="curr-directory-page.html">Относительная ссылка на страницу в текущем каталоге</a></li>
                    <li><a href="about/about.html">Относительная ссылка на страницу в каталоге about</a></li>
                    <li><a href="../tasks.html">Ссылка на страницу в каталоге уровня выше текущей</a></li>
                    <li><a href="../../web.html">Ссылка на страницу в каталоге двумя уровнями выше текущей</a></li>
                    <li><p> Контекстная ссылка: <br>
                        <h1 style="font-size: 20px;">В этом тексте есть <a href="https://loremipsum.io/ru">Ссылка</a> красивая</h1>
                    </p></li>
                    <li><a href="https://kubsu.ru/index.php#block-system-main">Ссылка на фрагмент страницы стороннего сайта</a></li>
                    <li>
                        <img usemap="#primary" src="images/кубгу.jpg" alt="Лого КубГУ">
                        <map name="primary">
                            <area shape="rect" coords="0,0,100,100" href="https://kubsu.ru/index.php" alt="Сайт университета">
                            <area shape="circle" coords="100,100,50" href="https://t.me/kubsunews" alt="Канал телеграм">
                        </map>
                    </li>
                    <li><a href="">Ссылка с пустым href</a></li>
                    <li><a>Ссылка без href</a></li>
                    <li><a href="https://kubsu.ru" rel="nofollow">Ссылка, по которой запрещен переход поисковиками</a></li>
                    <li><a href="https://kubsu.ru" rel="noindex">Ссылка, запрещенная для индексации поисковиками</a></li>
                    <li>
                        <ol>
                            <li><a href="https://kubsu.ru" title="Это сайт КубГУ">Наведи на меня</a></li>
                            <li><a href="" title="Что-то еще">...</a></li>
                        </ol>
                    </li>
                    <li><a href="ftp://login:password@example.com/file.txt">Ссылка на файл на сервере FTP с авторизацией</a></li>
                </ul>
            </div>
            
            <div class="content d-flex">
                <table class="data-table pt-3" >
                    <thead>
                        <tr>
                            <th>Название блюда</th>
                            <th>Гр</th>
                            <th>Руб</th>
                            <th>Ккал</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Шашлык свинина шея (шампур)</td>
                            <td>250</td>
                            <td>450,00</td>
                            <td>548</td>
                        </tr>
                        <tr>
                            <td>Колбаски куриные 2 шт</td>
                            <td>200</td>
                            <td>320,00</td>
                            <td>325</td>
                        </tr>
                        <tr>
                            <td>Крылышки Баффало 3 шт</td>
                            <td>200</td>
                            <td>250,00</td>
                            <td>557</td>
                        </tr>
                        <tr>
                            <td>Картофель с салом (шампур)</td>
                            <td>200</td>
                            <td>120,00</td>
                            <td>394</td>
                        </tr>
                        <tr>
                            <td>Шампиньоны (шампур)</td>
                            <td>200</td>
                            <td>250,00</td>
                            <td>73</td>
                        </tr>
                        <tr>
                            <td>Огурчики маринованные</td>
                            <td>100</td>
                            <td>90,00</td>
                            <td>22</td>
                        </tr>
                    </tbody>
                </table>
            </div><br>
            <div class="calc p-3">
                <h1>Калькулятор стоимости заказа</h1>
                <label for="quantity">Количество:</label>
                <input type="number" class="p-1 mb-3" id="quantity" min="1" value="1">
                <label>Обедики:</label>
                <div style="display: flex;">
                    <input type="radio" id="service1" name="service" value="450" checked>
                    <label for="service1">Шашлык свинина шея (шампур) - 450 руб</label>
                </div>
                <div style="display: flex;">
                    <input type="radio" id="service2" name="service" value="320">
                    <label for="service2">Колбаски куриные 2 шт - 320 руб</label>
                </div>
                <div style="display: flex;">
                    <input type="radio" id="service3" name="service" value="250">
                    <label for="service3">Крылышки Баффало 3 шт - 250 руб</label>
                </div>
                <div style="display: flex;">
                    <input type="radio" id="service4" name="service" value="120">
                    <label for="service4">Картофель с салом (шампур) - 120 руб</label>
                </div>
                <div style="display: flex;">
                    <input type="radio" id="service5" name="service" value="250">
                    <label for="service5">Шампиньоны (шампур) - 250 руб</label>
                </div>
                <div style="display: flex;">
                    <input type="radio" id="service6" name="service" value="90">
                    <label for="service6">Огурчики маринованные - 90 руб</label>
                </div><br>
                <label for="option">Дополнительно:</label>
                <select id="option">
                    <option value="0">Без дополнений</option>
                    <option value="37">Кепчук (+37 руб.)</option>
                    <option value="37">Горчичка(+37 руб.)</option>
                </select><br>
                <label for="property">Пробковый сбор:</label>
                <div style="display: flex;">
                    <input type="checkbox" id="property" value="1000">
                    <label for="property">1000 рубликов</label>
                </div><br>
                <button id="calculate">Рассчитать стоимость</button><br>
                <div id="result" class="mt-1"></div>
            </div><br>
    <div class="container-fluid d-flex ">
            <form action="test@example.com">
                <label>ФИО: <input type="text" required="required"><br></label>
                <label>Телефон: <input type="tel" required="required"><br></label>
                <label>E-mail: <input type="email" required="required"><br></label>
                <label>Дата рождения: <input type="date" required="required"><br></label>

                <label>Пол:</label>
                <label><input type="radio" name="gender" required="required">М</label>
                <label><input type="radio" name="gender" required="required">Ж<br></label>

                <label >
                        Любимый язык программирования: 
                        <select name="prog-lang" id="prog-lang" required="required">
                            <option value="">JavaScript</option>
                            <option value="">PHP</option>
                            <option value="">Python</option>
                            <option value="">Java</option>
                            <option value="">Pascal</option>
                            <option value="">С</option>
                            <option value="">С++</option>
                            <option value="">Haskel</option>
                            <option value="">Clojure</option>
                            <option value="">Prolog</option>
                            <option value="">Scala</option>
                        </select>
                    </input  type="checkbox">
                    <br>
                </label>

                <label>
                    Биография:<br>
                    <textarea name="bio" id="bio"></textarea><br>
                </label>
                
                <label><input type="checkbox">С контрактом ознакомлен(-а)</label><br>
                <input type="submit" style="width: 50%; display: flex;" value="Сохранить">
            </form>
        </div><br>
        <div class="gallery-container">
            <button class="arrow left" onclick="moveSlide(-1)">&#10094;</button>
            <div class="gallery">
                <div class="slides">
                    <div class="slide">
                        <img src="images/еще шашлык.jpg" alt="Image 1">
                    </div>
                    <div class="slide">
                        <img src="images/картоха.jpg" alt="Image 2">
                    </div>
                    <div class="slide">
                        <img src="images/рассол.webp" alt="Image 3">
                    </div>
                    <div class="slide">
                        <img src="images/стол.jfif" alt="Image 4">
                    </div>
                    <div class="slide">
                        <img src="images/шашлычок.png" alt="Image 5">
                    </div>
                    <div class="slide">
                        <img src="images/шашлык.jpg" alt="Image 6">                        
                    </div>
                    <div class="slide">
                        <img src="images/блюдо.jfif" alt="Image 7">
                    </div>
                    <div class="slide">
                        <img src="images/шашлычок.jpg" alt="Image 8">
                    </div>
                </div>
            </div>
            <button class="arrow right" onclick="moveSlide(1)">&#10095;</button>
        </div>
        
        <div class="pager">
            <span id="current-page">1</span> / <span id="total-pages">5</span>
        </div><br>

        <button id="openPopup">Открыть форму</button>
        <div class="popup" id="popup">
            <div class="popup-content">
            <button id="closePopup" class="close-button">&times;</button> 
            <h2>Форма обратной связи</h2>
            <form id="contactForm">
                <label for="name">ФИО:</label>
                <input type="text" id="name" name="name" placeholder="Ваше имя" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="Ваш email" required>

                <label for="phone">Телефон:</label>
                <input type="tel" id="phone" name="phone" placeholder="Ваш телефон" required>

                <label for="organization">Организация:</label>
                <input type="text" id="organization" name="organization" placeholder="Ваша организация">

                <label for="message">Сообщение:</label>
                <textarea id="message" name="message" placeholder="Ваше сообщение" required></textarea>

                <div style="display: flex;">
                    <input type="checkbox" id="agreement" name="agreement" required> 
                    <label for="agreement">Я согласен с <a href="#">политикой обработки персональных данных</a></label>
                </div>

                <button type="submit" id="submitBtn">Отправить</button>
                <div class="message" id="messageArea"></div>
            </form>
            </div>
        </div>  
    </div>
    </div>
    <footer class="footer p-2">
        <div class="footer-content">
            <p>&copy; Алиева Анжелика</p>
        </div>
    </footer>
    <script>
        const quantityInput = document.getElementById('quantity');
        const serviceRadios = document.querySelectorAll('input[name="service"]');
        const optionSelect = document.getElementById('option');
        const propertyCheckbox = document.getElementById('property');
        const calculateButton = document.getElementById('calculate');
        const resultDiv = document.getElementById('result');
        function calculateCost() {
          const quantity = parseInt(quantityInput.value);
          let price = 0;
          let selectedService = null;
    
          for (const radio of serviceRadios) {
            if (radio.checked) {
              selectedService = radio;
              price = parseInt(radio.value);
              break;
            }
          }
    
        if (selectedService) {
            if (selectedService.id === 'service4' || selectedService.id === 'service5' || selectedService.id === 'service6') {
              optionSelect.style.display = 'block';
              propertyCheckbox.style.display = 'none';
              if(selectedService.id === 'service4' || selectedService.id === 'service5'){
                propertyCheckbox.style.display = 'block';
                if (propertyCheckbox.checked ) {
                    price += parseInt(propertyCheckbox.value);
                }   
                }
              price += parseInt(optionSelect.value);
            }
            else if (selectedService.id === 'service3' || selectedService.id === 'service1' || selectedService.id === 'service2') {
              propertyCheckbox.style.display = 'none';
              optionSelect.style.display = 'none';
              if(selectedService.id === 'service3' || selectedService.id === 'service1'){
                propertyCheckbox.style.display = 'block';
                if (propertyCheckbox.checked ) {
                    price += parseInt(propertyCheckbox.value);
                }
              } 
            }
            else {
              optionSelect.style.display = 'none';
              propertyCheckbox.style.display = 'none';
            }
          }
          if (quantity <= 0 || isNaN(quantity)) {
              resultDiv.textContent = 'Некорректное количество товара!';
              return;
          }
          const totalCost = quantity * price;
          resultDiv.textContent = `Стоимость заказа: ${totalCost} руб.`;
        }
        serviceRadios.forEach(radio => {
          radio.addEventListener('change', calculateCost);
        });
        calculateButton.addEventListener('click', calculateCost);





        //Слайдер
        let currentSlide = 0; // Индекс текущей страницы
        const totalSlides = 8; // Общее количество слайдов
        const slidesToShow = window.innerWidth <= 768 ? 1 : 3; // Установка количества слайдов для показа
        const totalPages = window.innerWidth <= 768 ? 8 : 6; // Общее количество страниц

        document.getElementById('total-pages').textContent = totalPages;

        function updatePager() {
            document.getElementById('current-page').textContent = currentSlide + 1;
        }

        function moveSlide(direction) {
            currentSlide += direction;

            // Проверка границ текущего индекса страницы
            if (currentSlide < 0) {
                currentSlide = 0;
            } else if (currentSlide >= totalPages) {
                currentSlide = totalPages - 1;
            }

            // Вычисляем смещение для слайдов
            const gallery = document.querySelector('.slides');
            const offset = window.innerWidth <= 768 ? -currentSlide * (100 / 1) : -currentSlide * (100 / 3);
            gallery.style.transform = `translateX(${offset}%)`;
            updatePager();
        }

        const openPopupBtn = document.getElementById('openPopup');
    const popup = document.getElementById('popup');
    const contactForm = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const messageArea = document.getElementById('messageArea');
    const closePopupBtn = document.getElementById('closePopup');

    // Загружаем данные из LocalStorage
    const storedData = localStorage.getItem('formData');
    if (storedData) {
      const data = JSON.parse(storedData);
      document.getElementById('name').value = data.name || '';
      document.getElementById('email').value = data.email || '';
      document.getElementById('phone').value = data.phone || '';
      document.getElementById('organization').value = data.organization || '';
      document.getElementById('message').value = data.message || '';
    }

    // Открыть попап
    openPopupBtn.addEventListener('click', () => {
      popup.style.display = 'flex';
      history.pushState({}, '', '#contact'); // Изменить URL
    });

    // Закрыть попап
    closePopupBtn.addEventListener('click', () => {
      popup.style.display = 'none';
      history.pushState({}, '', '#'); // Вернуть URL
    });

    // Закрыть попап при нажатии "Назад"
    window.addEventListener('popstate', () => {
      popup.style.display = 'none';
    });

    // Отправка формы
    contactForm.addEventListener('submit', (event) => {
      event.preventDefault();

      // Проверка согласия с политикой
      const agreementCheckbox = document.getElementById('agreement');
      if (!agreementCheckbox.checked) {
        messageArea.textContent = 'Пожалуйста, согласитесь с политикой обработки персональных данных.';
        return;
      }

      // Отключение кнопки отправки
      submitBtn.disabled = true;
      messageArea.textContent = 'Отправка...';

      // Создание объекта с данными формы
      const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        organization: document.getElementById('organization').value,
        message: document.getElementById('message').value,
      };

      // Метод XHR
      const xhr = new XMLHttpRequest();
      xhr.open('POST', 'https://formcarry.com/s/t5C3Z9nIbL-', true); 
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onload = function() {
        if (xhr.status >= 200 && xhr.status < 300) {
          messageArea.textContent = 'Ошибка при отправке формы. Пожалуйста, попробуйте ещё раз.';
          contactForm.reset(); 
          localStorage.setItem('formData', JSON.stringify(formData)); 
        } else {
          messageArea.textContent = 'Форма успешно отправлена!';
        }
        submitBtn.disabled = false;
      };
      xhr.onerror = function() {
        messageArea.textContent = 'Форма успешно отправлена!';
        submitBtn.disabled = false;
      };
      xhr.send(JSON.stringify(formData));
    });
    </script>
    <script src="/docs/5.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

</body>
</html>